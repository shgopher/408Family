# TCP协议
## TCP协议的三次握手
1. 客户端给服务器端发送了syn，然后服务器端收到了，这个syc
2. 服务器将收到的syn和自己的应答ack发送给浏览器，这个时候浏览器的状态变成了established就是确认可以通话了
3. 浏览器将这个ack再次发送给服务器，服务器自然就知道哦这是我给它的ack，所以我收到了消息，然后浏览器就也进入了可通话的状态了，至此这个沟通的通道就建立起来了。

因为tcp协议单向沟通，这样三次，通过两个syn和一个ack就确定了两个的通道的畅通，这样就可以交流了。

syn_sent（当客户端主动发送syc的时候发送的是syc_sent）和syn_rcvd(当服务器收到了客户端的syn_sent后，它就先来了一个ack然后就给了客户端一个syn_rcvd)，这两个状态叫着「半打开」状态，就是向对方招手了，但是还没来得及看到对方的点头微笑。syn_sent是主动打开方的「半打开」状态，syn_rcvd是被动打开方的「半打开」状态。客户端是主动打开方，服务器是被动打开方。
## TCP协议的四次握手
四次握手跟三次不一样的愿意在服务器不拿浏览器给发送的syn了，这里是fin这个流程是这样的

1. 浏览器发送fin提出分手，然后服务器收到了信息，
2. 它就发送了一个ask给浏览器说我知道了，但是它没有发送浏览器的fin
3.  服务器也给浏览器发送了一个fin也提出分手，
4.  这什么鬼双方均给对方提出分手，然后浏览器说我知道了。

这主要是tcp协议存在半关闭状态，当浏览器给服务器发送分手的信息后它已经不能不想说话了，但是能听，所以它听到了服务器的ask后就知道嗯可以分手了，

服务器说我也得提出分手，然后它也提出了分手，然后浏览器给它发送了ask，服务器听到后就关闭了，然后浏览器等了一会也关闭，这么说把 原来服务器才是女的。只不过浏览器这个渣男先提出分手后，有点恋恋不舍，在服务器关闭了一会后才关闭。
这个渣男自己独自微笑伤感了一个time_wait时间，这个时间一般是4分钟（两个msl时间 ：最长报文寿命）或者可以更改，等待4分钟后他也关闭了，释放了资源。

我们看一下为什么连同的时候是三次握手呢是因为连同的时候在知道对方喜欢自己的时候同时也给对方说我也喜欢你，然后分手的时候必须双方分别给对方分手一次。才结束，并且还有一个渣男独自伤感时期time_wait 这个时期它会重复的传一个ask，就是上海服务器两次说听到了，嗯听到了，如果这个第二次的重传的ask都传到了但是第一次的那个没有传到（导致服务器没有关闭）所以这就是重传的好处，确认真的要分手，那么第一次的aks就失效了。

其实四次握手也可以变成三次，就是跟三次握手一样，服务器发送ask的同时直接发fin就OK了。
## TCP协议的数据传输

tcp是单向传送，但是可是双向沟通，啥意思呢，单向的意思就是一次只能从a到b不能同时，但是双向沟通的意思是a可以给b传，b也可以给a传

tcp发送信息的时候，需要让对方发送一个已收到的信息它才放心，比如浏览器给服务器发送了一个json，然后服务器必须先给浏览器发送一个ask，然后浏览器收到了这个ask，哦哦哦它收到了收到了，太棒了，才完成这个传送，

然后服务器要响应数据给浏览器了，也是发送数据给浏览器，浏览器回复它一个ask，然后服务器说哦哦哦它收到了，可以哒

总结一句：就跟收到信息请回复 一个意思 a发送data给b b回了一个 已收到

### 批量处理

比如浏览器给服务器发送了9次消息，服务器给它发送了一个ask 这九条都收到啦。限制浏览器一次行发送的数据的次数就是tco窗口大小 这九条信息在http协议中还是一次的发送只是这次发送的时候分区分块的发送了9次，这跟http协议中管线处理，一次先处理好几个请求再队列式的返回不同。http协议中的好几次请求就是好几次的tcp协议的三次握手传送+4次握手 这个流程才http协议中才是一次发送。
